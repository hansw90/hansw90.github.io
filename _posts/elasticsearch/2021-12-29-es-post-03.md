---
title: "ES NORI 알아보기 (1) 데이터 색인과 텍스트 분석"
date: 2021-09-27-00:00:00 -0000
categories: ELASTICSEARCH

---
---
title: "ES 검색엔진 만들기 (1) 소방청 프로젝트 내에서 왜 ES를 사용하였는가?"
date: 2021-12-29-00:00:00 -0000
categories: ELASTICSEARCH
---

8월말 내가 소방청 프로젝트 (신고 전화내에서 대화를 분석해 긴급출동을 보조하는)에 투입되고, 

STT 와 TA 그리고 API 간의 파이프라인을 만들고 띵가띵가? 하려 할 때쯤,

__'승우씨 주소 검색은 어떻게 할꺼에요?'__ 라는 질문을 받게 되었다. 난 파이프라인과 STT메세지를 전처리 정도로 생각하고 맘이 편했는데?..

이말을 전해 들은 후, 일을 맡아서가 아닌, 주소를 어떻게 처리할까에 대한 고민으로 하루를 머리를 꽁꽁 싸매고 있었던것 같다.

이게 간단히 생각하면 굉장히 간단해 보인다. __STT CER도 굉장히 높고, 주소 키워드를 잡아주는것 까지 되는데, 이걸 그냥 검색하면 되지 않나?__  라고 생각할수 있을것이다.

또 카카오, 네이버 네비게이션을 키고 __서울시청 찾아줘__ 을 말하면 굉장히 잘 찾아주는걸 볼수 있다. 

자 이렇게 주변에서 답을 다 알려주었는데 왜 온종일 머리를 싸매고 있었는가??? 

전사데이터를 이곳에 적을수 없으니 내가 간단한 예를 들어 보도록 하겠다, __우리가 출동시켜야할 위치는 어딜까? 한번 찾아보자__

'' 안에 있는 단어는 주소 키워드이다.

EXAMPLE1
```
RX : 일일구 입니다
TX : 네 지금 '한강' 산책중에 여기 사람이 쓰러져 있어요 빨리와주세요
RX : '한강' 어디신데요?
TX : 여기가 지금 '예시동' 인데요
RX : '예시동 한강공원' 으로 가면 되나요
TX : 아 여기 '한대 병원' 이 보여요
RX : '병원' 이요
TX : 네 '병원' 맞아요
RX : 네 알겠습니다 지금 출발하겠습니다
```
EXAMPLE2
```
RX : 일일구 입니다
TX : 여기 친구랑 대화중에 친구가 쓰러진것 같아요. 말이 없어요
RX : 친구가 어디살아요?
TX : 친구 집이 `예시로` 아 아 어디였더라
RX : 천천히 말해주세요 `예시로`
TX : 아 `일일일 다시 이번지`요
RX : `일일일 다시 일번지` 맞나요
RX : 아니요 일말고 이요
```

굉장히 쉽다. 
- EXAMPLE1 은 __'한대 병원'__
- EXAMPLE2 는 __'예시로 111-2 번지'__ 로 출동 시키면된다.

근데 이걸 컴퓨터가 어떻게 알게 할까?... 
EXAMPLE1 에서는 주소 대상물이 7개 EXAPLE2에서는 대상물이 4개 심지어 마지막 __RX : 아니요 일말고 이요__ 는 대상물 키워드에 잡히지도 않았다.

또한 EXAMPLE1의 __'한대 병원'__ 의 정식명칭은 __'한국대학교 부속병원'__ 이였다고 생각해보면 이제 어떻게 접근해야 할지 좀 의문이 생길것이다.

나는 이번 ES 포스팅에선 EXAMPLE2와 같이 행정동/도로명 번지 검색은 룰로 처리를 하였기에, (이것도 ES로 할 방법은 있다.) 이번 포스팅에선 깊게 다루진 않겠다.

내가 다룰 내용은 EXAMPLE1을 어떻게 처리하였는지를 포스팅하고, 어떻게 하면 더 개선할수 있을지를 공유하고자 한다.

### 02. 왜 ES를 사용하였는가

Example1 중요 포인트는 뭘까?
1. 이전 주소 정보가 추후 나와야할 주소 정보에 영향을 미쳐야 한다.
  - '한대 병원'이 예시동에만 있는것이 아닌, 타 대학병원 처럼 여러곳에 위치한다,
2. '한대 병원'은 한국대학교 부속병원'과 동의어이다.
3. 모든걸 동의어에 정리하는것은 힘들다
  - 한국대학교 부속병원을 토크나이징 하면 ['한국', '대학교', '부속', '병원'] 이 된다.

